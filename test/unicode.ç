#inclou "test.c√ß"

#defineix CADENA(x) #x

def_tipus sense_signe curt car√†cter_16;
def_tipus sense_signe enter car√†cter_32;
def_tipus enter car√†cter_ample;

enter œÄ = 3;

enter principal() {
  AFIRMA(4, mida_de(L'\0'));
  AFIRMA(97, L'a');

  AFIRMA(0, compara_cadenes("Œ±Œ≤Œ≥", "\u03B1\u03B2\u03B3"));
  AFIRMA(0, compara_cadenes("Êó•Êú¨Ë™û", "\u65E5\u672C\u8A9E"));
  AFIRMA(0, compara_cadenes("Êó•Êú¨Ë™û", "\U000065E5\U0000672C\U00008A9E"));
  AFIRMA(0, compara_cadenes("üåÆ", "\U0001F32E"));

  AFIRMA(-1, L'\xffffffff'>>31);
  AFIRMA(946, L'Œ≤');
  AFIRMA(12354, L'„ÅÇ');
  AFIRMA(127843, L'üç£');

  AFIRMA(2, mida_de(u'\0'));
  AFIRMA(1, u'\xffff'>>15);
  AFIRMA(97, u'a');
  AFIRMA(946, u'Œ≤');
  AFIRMA(12354, u'„ÅÇ');
  AFIRMA(62307, u'üç£');

  AFIRMA(0, compara_cadenes(CADENA(u'a'), "u'a'"));

  AFIRMA(4, mida_de(U'\0'));
  AFIRMA(1, U'\xffffffff'>>31);
  AFIRMA(97, U'a');
  AFIRMA(946, U'Œ≤');
  AFIRMA(12354, U'„ÅÇ');
  AFIRMA(127843, U'üç£');

  AFIRMA(0, compara_cadenes(CADENA(U'a'), "U'a'"));

  AFIRMA(4, mida_de(u8"abc"));
  AFIRMA(0, compara_cadenes(u8"abc", "abc"));

  AFIRMA(0, compara_cadenes(CADENA(u8"a"), "u8\"a\""));

  AFIRMA(2, mida_de(u""));
  AFIRMA(10, mida_de(u"\xffzzz"));
  AFIRMA(0, compara_mem(u"", "\0\0", 2));
  AFIRMA(0, compara_mem(u"abc", "a\0b\0c\0\0\0", 8));
  AFIRMA(0, compara_mem(u"Êó•Êú¨Ë™û", "\345e,g\236\212\0\0", 8));
  AFIRMA(0, compara_mem(u"üç£", "<\330c\337\0\0", 6));
  AFIRMA(u'Œ≤', u"Œ≤b"[0]);
  AFIRMA(u'b', u"Œ≤b"[1]);
  AFIRMA(0, u"Œ≤b"[2]);

  AFIRMA(0, compara_cadenes(CADENA(u"a"), "u\"a\""));

  AFIRMA(4, mida_de(U""));
  AFIRMA(20, mida_de(U"\xffzzz"));
  AFIRMA(0, compara_mem(U"", "\0\0\0\0", 4));
  AFIRMA(0, compara_mem(U"abc", "a\0\0\0b\0\0\0c\0\0\0\0\0\0\0", 16));
  AFIRMA(0, compara_mem(U"Êó•Êú¨Ë™û", "\345e\0\0,g\0\0\236\212\0\0\0\0\0\0", 16));
  AFIRMA(0, compara_mem(U"üç£", "c\363\001\0\0\0\0\0", 8));
  AFIRMA(u'Œ≤', U"Œ≤b"[0]);
  AFIRMA(u'b', U"Œ≤b"[1]);
  AFIRMA(0, U"Œ≤b"[2]);
  AFIRMA(1, U"\xffffffff"[0] >> 31);

  AFIRMA(0, compara_cadenes(CADENA(U"a"), "U\"a\""));

  AFIRMA(4, mida_de(L""));
  AFIRMA(20, mida_de(L"\xffzzz"));
  AFIRMA(0, compara_mem(L"", "\0\0\0\0", 4));
  AFIRMA(0, compara_mem(L"abc", "a\0\0\0b\0\0\0c\0\0\0\0\0\0\0", 16));
  AFIRMA(0, compara_mem(L"Êó•Êú¨Ë™û", "\345e\0\0,g\0\0\236\212\0\0\0\0\0\0", 16));
  AFIRMA(0, compara_mem(L"üç£", "c\363\001\0\0\0\0\0", 8));
  AFIRMA(u'Œ≤', L"Œ≤b"[0]);
  AFIRMA(u'b', L"Œ≤b"[1]);
  AFIRMA(0, L"Œ≤b"[2]);
  AFIRMA(-1, L"\xffffffff"[0] >> 31);

  AFIRMA(0, compara_cadenes(CADENA(L"a"), "L\"a\""));

  AFIRMA(u'Œ±', ({ car√†cter_16 x[] = u"Œ±Œ≤"; x[0]; }));
  AFIRMA(u'Œ≤', ({ car√†cter_16 x[] = u"Œ±Œ≤"; x[1]; }));
  AFIRMA(6, ({ car√†cter_16 x[] = u"Œ±Œ≤"; mida_de(x); }));

  AFIRMA(U'ü§î', ({ car√†cter_32 x[] = U"ü§îx"; x[0]; }));
  AFIRMA(U'x', ({ car√†cter_32 x[] = U"ü§îx"; x[1]; }));
  AFIRMA(12, ({ car√†cter_32 x[] = U"ü§îx"; mida_de(x); }));

  AFIRMA(L'ü§î', ({ car√†cter_ample x[] = L"ü§îx"; x[0]; }));
  AFIRMA(L'x', ({ car√†cter_ample x[] = L"ü§îx"; x[1]; }));
  AFIRMA(12, ({ car√†cter_ample x[] = L"ü§îx"; mida_de(x); }));

  AFIRMA(3, œÄ);
  AFIRMA(3, ({ enter „ÅÇŒ≤0¬æ=3; „ÅÇŒ≤0¬æ; }));
  AFIRMA(5, ({ enter $$$=5; $$$; }));

  imprimeix("OK\n");
  retorna 0;
}
